<meta charset="utf-8"/>
<!-- You must include this JavaScript file -->
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

<!-- For the full list of available Crowd HTML Elements and their input/output documentation,
      please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html -->

<!-- You must include crowd-form so that your task submits answers to MTurk -->
<crowd-form answer-format="flatten-objects">

  <crowd-instructions link-text="View instructions" link-type="button">
    <short-summary>
      <p>Adjust the slider so that the image is as compressed as it can be without changing the image quality.</p>
    </short-summary>

    <detailed-instructions>
      <h3>Provide more detailed instructions here</h3>
      <p>The slider bar under each image controls the compression level of the image.</p>
    </detailed-instructions>

    <positive-example>
      <p>Provide an example of a good answer here</p>
      <p>Explain why it's a good answer</p>
    </positive-example>

    <negative-example>
      <p>Provide an example of a bad answer here</p>
      <p>Explain why it's a bad answer</p>
    </negative-example>
  </crowd-instructions>

  <div>
    <p>(Sandbox version)</p>
    <p>How old are you?</p>
    <crowd-input name="age" placeholder="Age" required></crowd-input>
  </div>

  <div>
      <!-- <a href="https://ibb.co/fGMVrCc"><img src="https://i.ibb.co/sJjpsFB/Shiba-Inu-2.jpg" alt="Shiba-Inu-2" border="0"></a> -->
     <!--  <img src= "https://s3.amazonaws.com/mturk/samples/image_category/dog.jpg" style="width:600px;"> -->
       <img id='img' src ="https://i.ibb.co/sRZ4MnF/test3.png" style="width:600px;" class = "center">
       <style>
          .center{
          display: block;
          margin-left: auto;
          margin-right: auto;
          width: 50%;
        }
       </style>
  </div>
 
 <div>
    <h2 class = "center class_slider">Slide to compress image</h2>
    <!-- <input onchange='setImage(this)' type='range' min='0' max='24' value='0' id='slider' name ="slider" width ="100px"></input> -->
    <input onchange='setImage(this)' type='range' min='1' max='40' value='0' id='slider' name ="slider" class="center class_slider"  editable = 'true' pin ='true'> </input>
    <div id='dispDiv' style='margin-top:2em;'class="center class_slider"></div>
        <style>
            .class_slider {
              width: 500px;
            }
        </style>

    <h2 class="btn btn-primary">click for next image </h2>
    <input type="button" onclick="setImageb(1)" id='next button' name='next button' class="btn btn-primary">Next Button</input>
 </div>
 
 <script>
     var names
     var nexts = 0 
     var slider = document.getElementById("slider");
     var a = 0;
     var dispDiv = document.getElementById("dispDiv");
     dispDiv.innerHTML = "Slider value is " + a;
     
     var img = document.getElementById('img');
     var img_array = 
        ['https://i.ibb.co/Z82P8tc/test0.jpg',
        'https://i.ibb.co/k0rc51v/test00.jpg',
        'https://i.ibb.co/WcZbvf7/test1.jpg',
        'https://i.ibb.co/YDQZ4jN/test2.jpg',
        'https://i.ibb.co/DrTrTpH/test7.jpg',
        'https://i.ibb.co/NWFtMwF/test4.jpg',
        'https://i.ibb.co/JQPwML3/test8.jpg',
        'https://i.ibb.co/BP2y6Cd/test6.jpg',
        'https://i.ibb.co/hy6Tx7h/test9.jpg',
        'https://i.ibb.co/Hn0Wyfx/test8.jpg',
        'https://i.ibb.co/qsw3Gs5/test10.jpg',
        'https://i.ibb.co/HYPtJPw/test10.jpg',
        'https://i.ibb.co/9NHjRBs/test11.jpg',
        'https://i.ibb.co/s2rW9MG/test12.jpg',
        'https://i.ibb.co/6ghVnFq/test12.jpg',
        'https://i.ibb.co/0MPXbc5/test14.jpg',
        'https://i.ibb.co/m8mGs1P/test13.jpg',
        'https://i.ibb.co/nQN2LTn/test16.jpg',
        'https://i.ibb.co/Fw8S3DJ/test14.jpg',
        'https://i.ibb.co/NV8sPW1/test18.jpg',
        'https://i.ibb.co/jV3PYdj/test15.jpg',
        'https://i.ibb.co/vLWjW6d/test20.jpg',
        'https://i.ibb.co/2gNPrhN/test16.jpg',
        'https://i.ibb.co/wYVJfrN/test22.jpg',
        'https://i.ibb.co/tL13DSr/test17.jpg',
        'https://i.ibb.co/tKhtPGL/test24.jpg',
        'https://i.ibb.co/QdQDQtG/test18.jpg',
        'https://i.ibb.co/XX4QQxp/test26.jpg',
        'https://i.ibb.co/M7t1cgm/test19.jpg',
        'https://i.ibb.co/6vLsttT/test28.jpg',
        'https://i.ibb.co/1KWqqJh/test20.jpg',
        'https://i.ibb.co/txbFC8t/test30.jpg',
        'https://i.ibb.co/NLD4KrS/test21.jpg',
        'https://i.ibb.co/nzxhPhr/test32.jpg',
        'https://i.ibb.co/S3JP4h5/test22.jpg',
        'https://i.ibb.co/1KdTZsq/test34.jpg',
        'https://i.ibb.co/pndP8ym/test23.jpg',
        'https://i.ibb.co/qFjPpT4/test36.jpg',
        'https://i.ibb.co/Pz7WwJp/test24.jpg',
        'https://i.ibb.co/3dPYT0j/test25.jpg',
        'https://i.ibb.co/3dPYT0j/test25.jpg'];
             
    function setImageb(button){
        rand_image_disp.src = "https://snako.s3.us-east-2.amazonaws.com/" + names[nexts+1];
        nexts = nexts+1;
    }

    function setImage(slider){
        var value = slider.value;
        img.src = img_array[value];
    }
    setInterval(function(){ setImage(slider);}, 100);
    
     
    slider.addEventListener("change", function(){
        a = slider.value;
        dispDiv.innerHTML = "Slider value is "+a;
    })
         
    setInterval(function() {
      a = slider.value;
      dispDiv.innerHTML = "Slider value is " + a;
    }, 100)
     
 </script>
  <div>
       <img id='rand_image' src ="https://snako.s3.us-east-2.amazonaws.com/AVA__20278.jpg" style="width:600px;" class = "center">
       <style>
          .center{
          display: block;
          margin-left: auto;
          margin-right: auto;
          width: 50%;
        }
       </style>
       <crowd-input id='img_name' name='img_name' value='initial' type='hidden'></crowd-input>
  </div>

  <script>
    var rand_image_disp = document.getElementById("rand_image");
    var img_name = document.getElementById("img_name");
    var filenames_arr;
    var images_url = "https://snako.s3.us-east-2.amazonaws.com/8k_image_names_new.csv";
    var hit_list_url = "https://snako.s3.us-east-2.amazonaws.com/1_hit_list.csv"
    var hit_number_url = "https://snako.s3.us-east-2.amazonaws.com/1_hit_number.txt"
    var proxy_url = "https://cors-anywhere.herokuapp.com/";
    var bucket_url = "https://snako.s3.us-east-2.amazonaws.com/";
    var allText;
    var hit_sets;
    var hit_number;
    
    $.get(proxy_url + hit_number_url, function( data ) {
      hit_number = data;
      $.ajax({
    	    type: "GET",  
    	    url: proxy_url + hit_list_url,
    	    dataType: "text",       
    	    success: function(response)  
    	    {
    		    var option = "random";
    		    hit_sets = $.csv.toArrays(response);
    		    var i_set = (hit_number % hit_sets.length)
    		    var hit_set = hit_sets[i_set].toString();
    		    names = hit_set.split(",");
            var image_name = names[0];
    		    rand_image_disp.src = "https://snako.s3.us-east-2.amazonaws.com/" + image_name;
            img_name.value = image_name;
    		    
            }   
        });
    });
  </script>
</crowd-form>

