<!doctype html>
<html>

<head>
    <!--<meta charset="utf-8">-->
    <!--<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://assets.crowd.aws/crowd-html-elements.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bowser@2.5.3/es5.js"></script>
    <script src="2-bowser.js"></script>
    <link href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" media="all" rel="stylesheet" type="text/css">
    <link href="https://static.jquery.com/ui/css/demo-docs-theme/ui.theme.css" media="all" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <style>
        #slider {
            width: 38em;
            
        }
        
        #slider2 {
            width: 38em;
        }
        
        #slider.ui-slider-range {
            background: #f6931f;
        }
        
        #slider.ui-slider-handle {
            border-color: #729fcf;
        }
        
        #progressbar {
            width: 600px;
        }
        
        #Next_button {
            background-color: #4CAF50;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            width: 12em;
        }
        #Back_button {
            background-color: #4CAF50;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            width: 12em;
        }
        
        #submitButton {
            background-color: #4CAF50;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
        }
        img {
        border:1px solid black;
        }
    </style>
    <script>
        var study_second_slider_checker = false;
        var golden_i = [];
        var golden_mu = [];
        var golden_std = [];
        var repeated_i = [];
        var all_images = [];
        var set_size;
        var num_total_sets;
        var num_golden;
        var num_repeated;
        var repeated_thresh;
        var srcc_thresh;
        var rep_ind_first = []
        var rep_ind_second = []
        var first_rep_scores = new Array(num_repeated);       
        first_rep_scores.fill(-1);
        var golden_scores = new Array(num_golden);
        golden_scores.fill(-1);

        var second_slider = false;
        var flag = false;
        var golden_image_study = true;
        var names = [];
        var n_slider_levels = 50;
        var nexts = 0;
        var bucket_url = "https://snako.s3.us-east-2.amazonaws.com/";
        var hit_list_url = "https://snako.s3.us-east-2.amazonaws.com/1_hit_list.csv"
        var hit_data_url = "https://snako.s3.us-east-2.amazonaws.com/1_hit_data.csv"
        var key = "1_hit_number0.txt";
        var hit_number_url = bucket_url + key;
        var proxy_url = "https://cors-anywhere.herokuapp.com/";
        // var proxy_url = "";
        var allText;
        var hit_sets;
        var hit_number;
        var slider_vals = '';
        var slider_vals2 = ''
        var phase = 'begin_class';//var phase = 'beginning';
        var tutorial_names = ['AVA__809598.jpg', 'EMOTIC__COCO_train2014_000000154329.jpg', 'EMOTIC__COCO_train2014_000000128826.jpg'] // 'EMOTIC__COCO_train2014_000000104079.jpg', 
        var golden_names = ['AVA__20278.jpg', 'EMOTIC__4wl5mafxcb0nacmnzr.jpg', 'EMOTIC__COCO_train2014_000000571644.jpg',
            'EMOTIC__COCO_val2014_000000031983.jpg', 'EMOTIC__COCO_val2014_000000045685.jpg',
            'EMOTIC__COCO_val2014_000000147471.jpg', 'EMOTIC__COCO_val2014_000000464134.jpg',
            'EMOTIC__COCO_val2014_000000534041.jpg', 'JPEGImages__2007_003137.jpg',
            'JPEGImages__2008_002845.jpg', 'JPEGImages__2008_003688.jpg', 'JPEGImages__2008_003701.jpg',
            'JPEGImages__2008_004077.jpg', 'JPEGImages__2008_005266.jpg', 'JPEGImages__2008_006076.jpg',
            'JPEGImages__2008_006461.jpg', 'JPEGImages__2008_006554.jpg', 'JPEGImages__2008_006946.jpg',
            'JPEGImages__2008_007218.jpg', 'JPEGImages__2008_008544.jpg', 'JPEGImages__2009_000015.jpg',
            'JPEGImages__2009_001078.jpg', 'JPEGImages__2009_002872.jpg', 'JPEGImages__2009_002893.jpg',
            'JPEGImages__2009_004426.jpg', 'JPEGImages__2010_000088.jpg', 'JPEGImages__2010_002618.jpg',
            'JPEGImages__2010_003648.jpg', 'JPEGImages__2010_004257.jpg', 'JPEGImages__2011_000180.jpg',
            'JPEGImages__2011_002511.jpg', 'JPEGImages__2011_004079.jpg', 'JPEGImages__2011_006006.jpg',
            'JPEGImages__2011_007016.jpg', 'JPEGImages__2011_007090.jpg', 'JPEGImages__2012_000805.jpg',
            'JPEGImages__2012_003188.jpg', 'JPEGImages__2012_003896.jpg', 'JPEGImages__2012_004289.jpg',
            'VOC2012__2008_001175.jpg', 'VOC2012__2008_001855.jpg', 'VOC2012__2008_002589.jpg',
            'VOC2012__2008_003036.jpg', 'VOC2012__2008_004536.jpg', 'VOC2012__2008_008339.jpg',
            'VOC2012__2008_008503.jpg', 'VOC2012__2009_000151.jpg', 'VOC2012__2009_000659.jpg',
            'VOC2012__2009_000802.jpg', 'VOC2012__2009_001550.jpg', 'VOC2012__2009_002175.jpg',
            'VOC2012__2009_002794.jpg', 'VOC2012__2009_003177.jpg', 'VOC2012__2009_003324.jpg',
            'VOC2012__2009_004324.jpg', 'VOC2012__2010_000853.jpg', 'VOC2012__2010_005622.jpg',
            'VOC2012__2011_002173.jpg', 'VOC2012__2011_002215.jpg', 'VOC2012__2011_002960.jpg',
            'VOC2012__2011_003123.jpg', 'VOC2012__2011_003969.jpg', 'VOC2012__2011_005123.jpg',
            'VOC2012__2012_001367.jpg', 'VOC2012__2012_003683.jpg'
        ];

        var first = [
            ['the image through compression becomes blurry', 'wrong'],
            ['the image shows first signs of distortion becomes noticeable', 'right'],
            ['the image becomes unacceptable to the eye', 'wrong']
        ];
        
        var second = [
            ['the image through compression becomes blurry', 'wrong'],
            ['the image is still acceptable to the participant', 'wrong'],
            ['the image quality just begins to be compromised by compression', 'right']
        ];
        var third = [
            ['quality', 'right'],
            ['aesthetic', 'wrong'],
            ['content', 'wrong']
        ];
        var fourth = [
            ['Yes', 'right'],
            ['No', 'wrong'],
            ["I don't know", 'wrong']
        ];


        var tutorial_nexts = -1; // index for which tutorial image to display
        var first_image = true;
        var slight_change;
        var allowed_browsers = ['Chrome', 'Firefox', 'Microsoft Edge', 'Opera'];
        var supported = true
        
        // runs when the window loads
        // shows tutorial, hides everything else
        function init() {
            var result = bowser.getParser(navigator.userAgent).getResult();
            
            if(allowed_browsers.includes(result.browser.name) == false){
                alert('The browser you are using is not supported. Please use Google Chrome, Mozilla Firefox, Microsoft Edge, or Opera.');
                supported = false;
            } else if(result.platform.type !== 'desktop') {
                alert('This task is not supported on mobile devices. Please use a desktop or laptop to complete our task.');
                supported = false;
            };
            hideClass('image_class');
            hideClass('end_class');
            hideClass('slider_class');
            hideClass('tutorial_complete_class');
            hideClass('tutorial_text_class');
            document.getElementById('Back_button').style.display = "none";
            hideClass('quiz_class');
            hideClass('begin2_class');
            hideClass('begin3_class');
            hideClass('begin4_class');
            hideClass('failed_quiz');
            if(supported == true){
                showClass('begin_class');
                hideClass('not_supported_class');
            } else {
                hideClass('begin_class');
                showClass('not_supported_class');
                document.getElementById('Next_button').style.display = 'none';
            }
            
        }
        window.onload = init;
        
        // Parse user agent and get browser/mobile info
        window.addEventListener("load", function() {
            
        });

        //shuffling an array
        function shuffle(array) {
            for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
        }
        //shuffling questions array
        
        function shuffleArrays(){
            shuffle(first);
            shuffle(second);
            shuffle(third);
            shuffle(fourth);
        }

        //load questions
        function loadArray(){    

            var firstArr = document.getElementsByName('opt1');
            var secondArr = document.getElementsByName('opt2');
            var thirdArr = document.getElementsByName('opt3');
            var fourthArr = document.getElementsByName('opt4');
                    
            for(var i = 0; i< 3; i++){
                firstArr[i].nextSibling.innerHTML = first[i][0];
                firstArr[i].value = first[i][1];
                secondArr[i].nextSibling.innerHTML = second[i][0];
                secondArr[i].value = second[i][1];
                thirdArr[i].nextSibling.innerHTML = third[i][0];
                thirdArr[i].value = third[i][1];
                fourthArr[i].nextSibling.innerHTML = fourth[i][0];
                fourthArr[i].value = fourth[i][1];
            }
            
        }

        // shows all HTML elements in the specified class (except source_image)
        function showClass(class_name) {
            var x = document.getElementsByClassName(class_name);
            for (var i = 0; i < x.length; i++) {
                //console.log(x[i])
                if (x[i].id != 'source_image') {
                    x[i].style.display = "block";
                }
            }
        }

        // hides all HTML elements in the specified class
        function hideClass(class_name) {
            var x = document.getElementsByClassName(class_name);
            for (var i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
        }
        function goBack(){
            if(phase == "begin2_class"){
                hideClass('begin2_class');
                showClass('begin_class');
                phase = 'begin_class';
                window.scrollTo(0,0);
            }
            else if(phase == "begin3_class"){
                hideClass('begin3_class');
                showClass('begin2_class');
                phase = 'begin2_class';
                window.scrollTo(0,0);
            }
            else if(phase == "begin4_class"){
                hideClass('begin4_class');
                showClass('begin3_class');
                phase = 'begin3_class';
                window.scrollTo(0,0);
            }
        }

        
        function checkQuiz() {
            let q1_ans = $('input[name="opt1"]:checked').val();
            let q2_ans = $('input[name="opt2"]:checked').val();
            let q3_ans = $('input[name="opt3"]:checked').val();
            let q4_ans = $('input[name="opt4"]:checked').val();
            if(q1_ans == 'right' && q2_ans == 'right'&& 
                q3_ans == 'right' && q4_ans =='right') 
                return true
            else
                return false
        }

        // runs when "Next" button is pressed
        // note: tutorial_nexts and nexts increment at end of function
        function setImageb(button) {
            if (phase === 'begin_class') {
                document.getElementById('Back_button').style.display = "";
                hideClass('begin_class');
                showClass('begin2_class');
                phase = 'begin2_class';
                window.scrollTo(0,0);
            }   else if (phase === 'begin2_class') {
                hideClass('begin2_class');
                //showClass('begin2_class');
                showClass('begin3_class')
                phase = 'begin3_class';
                window.scrollTo(0,0);
            } else if (phase === 'begin3_class') {
                hideClass('begin3_class');
                //showClass('begin2_class');
                showClass('begin4_class');
                phase = 'begin4_class';
                window.scrollTo(0,0);
            } else if (phase === 'begin4_class'){
                hideClass('begin4_class');
                showClass('quiz_class');
                document.getElementById('Back_button').style.display = "none";
                phase = 'quiz'; // change to 'quiz' when ready for quiz logic
                window.scrollTo(0,0);
            } else if (phase === 'quiz') {
                hideClass('quiz_class');
                phase = 'beginning';
                if(checkQuiz() == true)
                    phase = 'beginning'
                else
                    phase = 'failed'

                var allRadios = document.getElementsByClassName('rads');
                for(var i = 0; i<allRadios.length; i++){
                    allRadios[i].checked = false;
                }

                document.getElementById('Next_button').click();
                window.scrollTo(0,0);
            } else if(phase == 'start'){
                hideClass('failed_quiz');
                showClass('begin_class');
                phase = 'begin_class';
            }


            // if showing tutorial
            else if (phase === 'beginning') {
                // if tutorial complete
                if (tutorial_nexts === tutorial_names.length - 1) {

                    document.getElementById('Next_button').style = 'visibility: hidden';
                    showClass('tutorial_complete_class');
                    hideClass('slider_class');
                    hideClass('image_class');
                    hideClass('tutorial_text_class');
                    phase = 'study';
                    second_slider = false;
                    get_set();

                    // if showing a tutorial image
                } else {
                    // if showing first tutorial image
                    document.getElementById("crowd-instr").style.display = "block";
                    if (tutorial_nexts === -1) {
                        showClass('tutorial_text_class');
                        showClass('slider_class');
                        showClass('image_class');
                        hideClass('begin_class');
                        hideClass('quiz_class');
                    }

                    if (second_slider == true) {

                        document.getElementById('Next_button').style.display = 'none';

                        $("#slider").slider({
                            orientation: "horizontal",
                            range: "max",
                            value: $("#slider").slider('value'), //n_slider_levels,
                            min: 0,
                            max: n_slider_levels,
                            disabled: true,
                        });
                        document.getElementById('slider').style.background = '#4CAF50';
                        if ($("#slider").slider('value') == 0) {
                            //Slider init
                            $("#slider2").slider({
                                orientation: "horizontal",
                                range: "max",

                                value: $("#slider").slider('value'),
                                min: 0,
                                max: 1,
                                disabled: false,

                            });

                        } else {

                            //Slider init
                            $("#slider2").slider({
                                orientation: "horizontal",
                                range: "max",

                                value: $("#slider").slider('value'),
                                min: 0,
                                max: $("#slider").slider('value'),
                                disabled: false,

                            });
                        }
                        document.getElementById('slider2').style.background = '#4CAF50';
                        // console.log($("#slider").slider('value'));
                        var orig_slider_val = $("#slider").slider('value');
                        var slider_width = 600 - (600 - 12 * (orig_slider_val));
                        //console.log(slider_width);
                        document.getElementById('slider2').style.width = String(slider_width) + 'px';
                        $("#jpeg_encode_quality").val($("#slider2").slider("value"));
                        console.log(document.getElementById('slider2')); //.setAttribute("disabled", "disabled");
                        tutorial_nexts = tutorial_nexts + 1;
                        second_slider = false;

                    } else {

                        // showing the next image (uncompressed)
                        var url = proxy_url + bucket_url + tutorial_names[tutorial_nexts + 1];
                        result_image.src = url;
                        source_image.src = url;

                        document.getElementById('Next_button').style = 'visibility: hidden';

                        //Slider init
                        $("#slider").slider({
                            orientation: "horizontal",
                            range: "max",
                            value: n_slider_levels,
                            min: 0,
                            max: n_slider_levels,
                            disabled: false,
                        });
                        document.getElementById('slider').style.background = '#4CAF50';
                        $("#jpeg_encode_quality").val($("#slider").slider("value"));
                        //Slider init
                        $("#slider2").slider({
                            orientation: "horizontal",
                            range: "max",
                            value: n_slider_levels,
                            min: 0,
                            max: n_slider_levels,
                            disabled: true,
                        });
                        document.getElementById('slider2').style.width = document.getElementById('slider').style.width;
                        document.getElementById('slider2').style.background = '#4CAF50';
                        // $("#jpeg_encode_quality").val($("#slider2").slider("value"));
                        // console.log(document.getElementById('slider2'));//.setAttribute("disabled", "disabled");
                        // tutorial_nexts = tutorial_nexts+1;
                        second_slider = true;
                    }
                }
                //setTimeout(1000);
            }

            // if showing non-tutorial images
            else if (phase === 'study') {

                // normal operation 
                if (first_image === false) {
                    // slider_vals = slider_vals + $("#slider").slider("value").toString() + ',';
                    // slider_vals = slider_vals + $("#slider2").slider("value").toString() + ',';
                    // only runs when transitioning from 'end of tutorial' screen to 'actual study' screen    
                } else {
                    first_image = false;
                    hideClass('tutorial_complete_class');
                    showClass('image_class');
                    showClass('slider_class');
                }

                if (second_slider == true) {
                    if(first_image != true){
                         slider_vals = slider_vals + $("#slider").slider("value").toString() + ',';
                    }
                    document.getElementById('Next_button').style.display = 'none';
                    $("#slider").slider({
                        orientation: "horizontal",
                        range: "max",
                        value: $("#slider").slider('value'),
                        min: 0,
                        max: n_slider_levels,
                        disabled: true,

                    });
                    if ($("#slider").slider('value') == 0) {

                       // $("#jpeg_encode_quality").val($("#slider").slider("value"));
                        $("#slider2").slider({
                            orientation: "horizontal",
                            range: "max",

                            value: $("#slider").slider('value'),
                            min: 0,
                            max: 1,
                            disabled: false,

                        });

                    } else {
                       // $("#jpeg_encode_quality").val($("#slider").slider("value"));
                        $("#slider2").slider({
                            orientation: "horizontal",
                            range: "max",

                            value: $("#slider").slider('value'),
                            min: 0,
                            max: $("#slider").slider('value'),
                            disabled: false,

                        });
                    }
                    document.getElementById('slider2').style.background = '#4CAF50';
                    // console.log($("#slider").slider('value'));
                    var orig_slider_val = $("#slider").slider('value');
                    var slider_width = 600 - (600 - 12 * (orig_slider_val));
                    //console.log(slider_width);
                    document.getElementById('slider2').style.width = String(slider_width) + 'px';
                    $("#jpeg_encode_quality").val($("#slider2").slider("value"));
                   // $("#jpeg_encode_quality").val($("#slider2").slider("value"));

                    //     if(nexts === names.length){ 
                    //     slider_values.value = slider_vals;
                    //     hideClass('image_class');
                    //     hideClass('slider_class');
                    //     showClass('end_class');
                    //     document.getElementById('submitButton').style = 'display: block;';
                    //     document.getElementById('Next_button').style = 'display: none;';
                    // }


                    nexts = nexts + 1;
                    second_slider = false;
                } else {
                    if(first_image !=true){
                        var second_slider_val = $("#slider2").slider("value");
                        // Second slider value is saved
                        slider_vals2 = slider_vals2 + second_slider_val.toString() + ',';
                        // For golden case
                        if (golden_i.indexOf(nexts-1) != -1 && !golden_image_study) {
                            golden_scores[golden_i.indexOf(nexts-1)] = second_slider_val;
                        }
                        // For repeated case first instance
                        if (rep_ind_first.indexOf(nexts-1) != -1 && !golden_image_study) {
                             first_rep_scores[rep_ind_first.indexOf(nexts-1)] = second_slider_val;
                        }
                        // For repeated case second instance
                        if (rep_ind_second.indexOf(nexts-1) != -1 && !golden_image_study) {
                             evalRejection(second_slider_val, nexts-1); 
                        }

                    }
                    second_slider = true;
                    // updating image
                    document.getElementById('result_image').crossOrigin = 'anonymous';
                    document.getElementById('source_image').crossOrigin = 'anonymous';
                    document.getElementById('result_image').style.display = "inline-block";
                    var image_src = proxy_url + bucket_url + names[nexts];
                    source_image.src = image_src;
                    result_image.src = image_src;
                    document.getElementById('Next_button').style = 'visibility: hidden';
                    $("#progressbar").progressbar({
                        value: (nexts * (100 / names.length)),
                        create: function(event, ui) {
                            $(this).find('.ui-widget-header').css({
                                'background-color': 'lightskyblue'
                            })
                        }
                    });
                    document.getElementById('progress_bar_items').style.textAlign = 'center';
                    document.getElementById("progress_bar_items").style.display = "block";
                    //Slider init
                    $("#slider").slider({
                        orientation: "horizontal",
                        range: "max",
                        value: n_slider_levels,
                        min: 0,
                        max: n_slider_levels,
                        disabled: false,

                    });
                    $("#jpeg_encode_quality").val($("#slider").slider("value"));
                    $("#slider2").slider({
                        orientation: "horizontal",
                        range: "max",
                        value: n_slider_levels,
                        min: 0,
                        max: n_slider_levels,
                        disabled: true,
                    });
                    document.getElementById('slider2').style.width = document.getElementById('slider').style.width;
                    // $("#jpeg_encode_quality").val($("#slider2").slider("value"));

                    // end screen
                    // if(nexts === names.length){ 
                    //     slider_values.value = slider_vals;
                    //     hideClass('image_class');
                    //     hideClass('slider_class');
                    //     showClass('end_class');
                    //     document.getElementById('submitButton').style = 'display: block;';
                    //     document.getElementById('Next_button').style = 'display: none;';
                    // }

                    // nexts = nexts+1;
                }

                

                // end screen
                if (nexts === names.length) {
                    if (!golden_image_study) { srcc_flag.value = evalFlag(); }
                    slider_values.value = slider_vals;
                    slider_values2.value = slider_vals2.slice(1,slider_vals2.length);
                      
                    hideClass('image_class');
                    hideClass('slider_class');
                    showClass('end_class');
                    document.getElementById('submitButton').style = 'display: block;';
                    document.getElementById('Next_button').style = 'display: none;';
                }

            }else if (phase == 'failed') {
                hideClass('image_class');
                hideClass('slider_class');
                showClass('failed_quiz');
                phase = 'start';

            }else if (phase == 'reject') {
                hideClass('image_class');
                hideClass('slider_class');
                showClass('reject');
                document.getElementById('Next_button').style = 'display: none;';

            } else {
                console.log('Phase not recognized: ', phase);
            }
        }

        // overwrites the set index file in bucket with new index
        function update_hit_number(num) {
            // configure identity pool
            AWS.config.update({
                region: 'us-east-2',
                credentials: new AWS.CognitoIdentityCredentials({
                    IdentityPoolId: 'us-east-2:cdec4f3c-4db2-46ea-86b1-a2081d62859e'
                })
            });

            // create s3 object
            var s3 = new AWS.S3({
                apiVersion: "2006-03-01",
                params: {
                    Bucket: "snako"
                }
            });

            // var params = {
            //   Bucket: "snako", 
            //   Key: key
            // };
            // s3.getObject(params, function(err, data) {
            //     if (err) { // an error occurred
            //         // console.log(err, err.stack);
            //         console.log('error');
            //     } 
            //     else {
            //         // console.log(data);
            //         console.log('1');
            //     }; 
            // });

            // make the new text file (with updated set index) that is to be uploaded
            var blob = new Blob([num.toString()], {
                type: "text/plain"
            });

            // upload the file
            params = {
                Bucket: 'snako',
                Key: key,
                Body: blob,
                ACL: 'public-read-write',

            };
            s3.upload(params, function(err, data) {
                console.log(err, data);
                // console.log('error');
            });

            // // Old code we want to save in case something goes wrong
            // var params = {
            //   AccessControlPolicy: {
            //   }, 
            //   Bucket: "snako", 
            //   GrantFullControl: "uri=http://acs.amazonaws.com/groups/global/AllUsers",     
            //   Key: key,
            //  };
            //  s3.putObjectAcl(params, function(err, data) {
            //   if (err) console.log(err, err.stack); // an error occurred
            //   else     console.log(data);           // successful response
            //  });
            // Use S3 ManagedUpload class as it supports multipart uploads
            // var upload = new AWS.S3.ManagedUpload({
            // params: params
            // {
            //   Bucket: "snako",
            //   Key: key,
            //   Body: blob,
            //   ACL: "public-read"
            // }
            // });

            // var promise = upload.promise();
            // promise.then(
            // function(data) {
            //   alert("Successfully uploaded file.");
            // },
            // function(err) {
            //   return alert("There was an error in updating the HIT number: ", err.message);
            // }
            // );
        }

        
        function get_set() {
            $.get(proxy_url + hit_number_url, function(data) {
                hit_number = parseInt(data);
                console.log('hit_number original read: ', data);
                $.ajax({
                    type: "GET",
                    url: proxy_url + hit_data_url,
                    dataType: "text",
                    success: function(response) {

                        var set_number = document.getElementById("set_number"); // the element that will export the set number in the results csv
                        set_number.value = hit_number;
                        hit_sets = $.csv.toArrays(response);
                        var i_set = (hit_number % hit_sets.length)
                        var hit_set = hit_sets[i_set].toString();
                        console.log('i_set: ', i_set);
                        if (golden_image_study === true) {
                            names = golden_names;
                            //  names = names.slice(0,3);

                        // FOR THE FINAL HIT
                        /*
                         * Data Format:
                         *   Number of study images per HIT (set size)
                         *   Image names in the set
                         *   Number of golden images
                         *   Number of repeated images
                         *   Repeated threshold
                         *   Spearman threshold
                         *   Golden image indeces 
                         *   Golden image mean values
                         *   Golden image stdev
                         *   Repeated image indeces (should be 2X number of repeated)
                         *      (first occurance ind. second occurance ind)
                         *
                         * This method will aim to read in the "hit_data.csv" and
                         * initialize the constrants of the study. 
                         * See above for data format.
                         */

                        } else {
                            data = hit_set.split(",");
                            set_size = parseInt(data.shift());
                            console.log("SET SIZE: " + set_size)
                            for (var i = 0; i < set_size; i++) { names.push(data.shift()); }
                            num_golden = parseInt(data.shift());
                            console.log("NUM GOLDEN: " + num_golden);
                            num_repeated = parseInt(data.shift());
                            console.log("NUM REPEATED: " + num_repeated);
                            repeated_thresh = parseInt(data.shift());
                            console.log("REPEATED THRESH: " + repeated_thresh);
                            srcc_thresh = parseInt(data.shift());
                            console.log("SRCC THRESH: " + srcc_thresh);
                            for (var i = 0; i < num_golden; i++) { golden_i.push(parseInt(data.shift())); }
                            for (var i = 0; i < num_golden; i++) { golden_mu.push(parseInt(data.shift())); }
                            for (var i = 0; i < num_golden; i++) { golden_std.push(parseInt(data.shift())); } 
                            for (var i = 0; i < num_repeated; i++) { rep_ind_first.push(parseInt(data.shift())); }
                            console.log("REPEATED FIRST: " + rep_ind_first);
                            for (var i = 0; i < num_repeated; i++) { rep_ind_second.push(parseInt(data.shift())); }
                            console.log("REPEATED SECOND: " + rep_ind_second);
                        }
                        update_hit_number(hit_number + 1);
                        document.getElementById('Next_button').style = 'visibility: block';
                    }
                });
            });
        }

        $(function() {
            var source_image = document.getElementById('source_image');
            var downloadingImage = new Image();
            downloadingImage.onload = function() {
                source_image.src = this.src;
            };
            downloadingImage = toDataURL(source_image.src, function(dataUrl) {
                console.log('RESULT:', '1') // dataUrl
            })
            var result_image = document.getElementById('result_image');
            var downloadingImage2 = new Image();
            downloadingImage2.onload = function() {
                result_image.src = this.src;
            };
            downloadingImage2 = toDataURL(result_image.src, function(dataUrl) {
                console.log('RESULT:', '1') // dataUrl
            })
            var output_format = "jpg";

            //Slider init
            $("#slider").slider({
                orientation: "horizontal",
                range: "max",
                value: 40,
                min: 0,
                max: 40,

                slide: function(event, ui) {
                    $("#jpeg_encode_quality").val(ui.value);
                }
            });

            //Slider init
            $("#slider2").slider({
                orientation: "horizontal",
                range: "max",
                value: 40,
                min: 0,
                max: 40,

                slide: function(event, ui) {
                    $("#jpeg_encode_quality").val(ui.value);
                }
            });

            $("#jpeg_encode_quality").val($("#slider").slider("value"));
            $("#slider").on("slide", function(event, ui) {
                document.getElementById('result_image').style.display = 'inline-block';
                document.getElementById('source_image').style.display = 'none';

                var encodeQuality = document.getElementById('jpeg_encode_quality');
                var source_image = document.getElementById('source_image');
                var result_image = document.getElementById('result_image');
                if (source_image.src == "") {
                    alert("You must load an image first!");
                    return false;
                }
                var quality = parseInt(encodeQuality.value);
                result_image.src = compress(source_image, quality, output_format).src;

                document.getElementById('Next_button').style = 'visibility: visible';

            });

            $("#jpeg_encode_quality").val($("#slider2").slider("value"));
            $("#slider2").on("slide", function(event, ui) {
                document.getElementById('result_image').style.display = 'inline-block';
                document.getElementById('source_image').style.display = 'none';

                var encodeQuality = document.getElementById('jpeg_encode_quality');
                var source_image = document.getElementById('source_image');
                var result_image = document.getElementById('result_image');
                if (source_image.src == "") {
                    alert("You must load an image first!");
                    return false;
                }
                var quality = parseInt(encodeQuality.value);
                result_image.src = compress(source_image, quality, output_format).src;

                document.getElementById('Next_button').style = 'visibility: visible';

            });
        });

        /*
         * BACKEND Hauling Methods
         *
         */

        // Evaluate whether a subjects should be rejected or not
        function evalRejection(score, rep_idx) {
            first_idx = rep_ind_first[rep_ind_second.indexOf(rep_idx)];
            if (Math.abs(score - first_rep_scores[first_idx]) > repeated_thresh) { 
                phase == 'reject'; 
            }
        }

        // Evaluates whether a participant is to be flagged for 
        // not meeting srcc thresholds
        function evalFlag() {
            var eval = orderedGScores();
            var srcc_val = spearman(eval.gscores_ordered.splice(num_golden,num_golden), 
                                    eval.gmeans_ordered.splice(num_golden,num_golden)
                                    );
            if (srcc_val < srcc_thresh) { return true; }
            else { return false; }
        }


        // Ordered golden scores to calculate spearman
        function orderGScores() {
            var gmeans_ordered = JSON.parse(JSON.stringify(golden_mu));
            var gscores_ordered = JSON.parse(JSON.stringify(golden_scores));
            var gmeans_i = [];
            var gmeans_sort = [];

            for (var i in golden_mu) {
                gmeans_sort.push([golden_mu[i], i]);
            }
            gmeans_sort.sort(function(left, right) {
                return left[0] < right[0] ? -1 : 1;
            });
            for (var j in gmeans_sort) {
                gmeans_ordered.push(gmeans_sort[j][0]);
                gmeans_i.push(gmeans_sort[j][1]);
            }

            for (var k = 0; k < golden_mu.length; k++) {
                gscores_ordered.push(golden_scores[gmeans_i[k]]);                
            }

            return {
                gmeans_ordered: gmeans_ordered,
                gscores_ordered: gscores_ordered
            };

        }

        // Spearman support function
        function getAVG(a) {
            sum = 0;
            for (let i = 0; i < a.length; i++) { sum+= a[i]; }
            return sum/a.length;
        }


        // Compression function
        function compress(source_img_obj, quality, output_format) {
            var mime_type;
            if (output_format === "png") {
                mime_type = "image/png";
            } else if (output_format === "webp") {
                mime_type = "image/webp";
            } else {
                mime_type = "image/jpeg";
            }

            var cvs = document.createElement('canvas');
            cvs.width = source_img_obj.naturalWidth;
            cvs.height = source_img_obj.naturalHeight;
            var ctx = cvs.getContext("2d").drawImage(source_img_obj, 0, 0);
            var newImageData = cvs.toDataURL(mime_type, 2 * quality / 100);
            var result_image_obj = new Image();
            result_image_obj.src = newImageData;
            return result_image_obj;
        };

        function toDataURL(url, callback) {
            var xhr = new XMLHttpRequest();
            xhr.onload = function() {
                var reader = new FileReader();
                reader.onloadend = function() {
                    callback(reader.result);
                }
                reader.readAsDataURL(xhr.response);
            };
            xhr.open('GET', url);
            xhr.responseType = 'blob';
            xhr.send();
        }

        toDataURL(source_image.src, function(dataUrl) {
            console.log('RESULT:', dataUrl)
        })

        /*
         * END BACKEND Hauling Methods
         *
         */
    </script>
</head>

<body>
    <div class="container">
        <h1 style="text-align: center;" class="display-4">Optimal Image Compression - Human Study</h1>
        <hr>
        <br>
        <crowd-form answer-format="flatten-objects" style="text-align: center;">
            <crowd-instructions style="display: none;" link-text="View instructions" link-type="button" id="crowd-instr">
                <br>
                <short-summary>

                    <!-- </1><p><b>Your task:</b> Adjust the slider to compress the image and try to find the point at which the
             <b>quality of the image just begins to change</b>.</p> -->
                    <p>
                        <b>Your task:</b> Adjust the slider and try to find the point at which sliding the bar <b>just begins 
          to compromise the quality of the image</b>.
                    </p>

                    <img src="https://media.giphy.com/media/J684vIRmGIDRLUskiJ/giphy.gif">
                </short-summary>

                <detailed-instructions>
   
                    <p>
                      <b>Your task:</b> Adjust the slider and try to find the point at which sliding the bar <b>just begins 
                         to compromise the quality of the image</b>. For example, if the slider is at a certain point 
                         <!-- KAN TODO: GIF OF IMAGE AT POINT PLEASE--> 
                         and the resulting image's quality is similar to the original's quality even after moving the slider 
                         a bit more to the left, 
                         <!-- KAN TODO: GIF OF SLIDER MOVING FROM POINT PLEASE--> 
                         then you can still move the slider to the left. If the slider is at a certain point and the resulting 
                         image's quality is substantially worse than the original's quality,
                         <!-- KAN TODO: GIF OF IMAGE AT POINT PLEASE--> 
                         then you have moved the slider too far to the left and must move the slider to the right. Your task 
                         is <b>not</b> to rate the aesthetic appeal of the image.
                    </p>
                    <p>
                      <b>Note:</b> The images may start off with different initial qualities. Because of this, base your 
                      answer <b>relative to the original, pristine image</b> (i.e when the slider bar is all the way to the 
                      right at 50). With some images, you may need to move the slider a lot without affecting the 
                      quality of images. With others, you may not need to move the slider too much before noticing a 
                      drop in quality.
                    </p>
                  <p>Perform this task for all of the images.</p>  
                  <img src="https://media.giphy.com/media/J684vIRmGIDRLUskiJ/giphy.gif"> 
                </detailed-instructions>
            
            <br>
                  
                    <!-- <div class = "row">
                        <div class = "col"> -->
                <positive-example> 
                   
                  <p><b>This is a good example of performing the task.</b></p>
                  <p>The slider is at a level where the image's quality is <b>mostly preserved</b>, but moving it more will compromise image quality.</p>
                  <img src="https://media.giphy.com/media/J684vIRmGIDRLUskiJ/giphy.gif">
                
            </positive-example>
            
            <!-- </div>
            <div class = "col"> -->
                
                <negative-example>
                   
                  <p><b>This is a bad example of performing the task.</b></p> 
                  <p>The image is too compressed. <b>Most of the image's quality is lost</b>, so image quality is compromised.</p>
                  <img src="https://media.giphy.com/media/Zcp7ZBJOC7iI5mRjhr/giphy.gif">
            
             </negative-example>
                <!-- </div>
</div> -->

            </crowd-instructions>
            
            
            
            
            
            <br>
            <div class="begin_class" style="display: none;">

                <h2>Introduction:</h2>
                <p> 
                    We are Electrical and Computer Engineering students at the University of Texas at Austin. We are
                    conducting this study for our senior design project to find the optimal compression ratios for images.
                    Your participation will provide valuable data for our project, and we appreciate you taking the time to 
                    complete our study.
                </p>
                <br>
            
                <h2>Instructions:</h2>
                <p>
                    In our task, you will be shown a series of images with two slider bars underneath each
                    image. Each slider bar controls the quality of the image by way of compression. For each
                    image, please use the first slider bar to indicate the point furthest to the left where
                    the resulting compressed image looks identical to the original image. Then, please use 
                    the second slider to indicate the point right before the resulting image becomes 
                    different enough from the original image to cause a slight drop in image quality.
                    <br>
                    <br>
                    The highest quality value is 50, and the lowest quality value is 0. Moving the sliders to the left will decrease 
                    the quality of the image. Each slider should be moved to its particular point, which will 
                    be explained in more detail in later pages in the instructions. 
                    The first slider will be the only one active until a value is selected and the "next" button is pressed. 
                    Then, the first slider will be disabled and the second slider will be activated.
                    After a value is chosen for the second slider, click "next" to proceed to the next image. 
                    <br>
                    <br>
                    Please read the instructions on the next few pages carefully! There will be a <b>short quiz</b> 
                    at the end of the instructions to make sure you understand how to complete our task. Once you
                    have passed the quiz and started the task, the instructions will always be available to you.
                    <br>
                    <br>
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/complete.gif"> 
                    <!-- gif of both sliders in action -->
                </p> 
            </div>

            <div class="begin2_class" style="display: none;">
                <p>
                    <h3>First Slider</h3>
                    For the first slider bar, adjust the slider and try to find the point <b>furthest to the left where the
                    image still looks identical to the original image</b>. In other words, try to find the point right before 
                    any distortion, or change between the resulting and original image, becomes noticeable. Below 
                    are one good example and two bad examples. 
                    <br>
                    <br>
                    <h5>Good Example</h5>
                    In the good example shown below, the slider is moved as far to the left as possible without causing any noticeable changes
                    in the image. Moving the slider any more to the left will cause a distortion in the resulting image, while moving the slider
                    to any point to the right of the current position will result in an image that looks the same as the original.
                    In particular, moving the slider any more to the left causes changes that can be seen in the 
                    cat's fur and in the blanket.
                    <br>
                    <br>
                    <!-- gif of good first slider, gif of first slider moving to point of first distortion and then pressing next -->
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/good1_full.gif"> 
                    <br>    
                    <br>
                    <br>
                    <h5>Bad Example 1</h5>
                    In this first bad example, the slider is not moved enough to the left. 
                    <br>
                    <br>
                    <!-- first slider at 50,  then compressed a little--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/too_high_1.gif"> 
                    <br>
                    <br>
                    The resulting image looks identical to the original image, even after moving the slider 
                    a bit more to the left. This means that you should move the slider more to the left, since
                    the first slider should be moved as far to the left as possible while the resulting compressed
                    image still looks identical to the original image. 
                    <br>
                    <br>
                    <!-- continuing from prev gif, first slider moves from "compressed a little" point to point of first distortion--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/too_high_2.gif"> 
                    <br>
                    <br>
                    <h5>Bad Example 2</h5>
                    In the second bad example, the slider is moved too far to the left. The resulting image already 
                    looks different than the original image before reaching this compression (slider) value.
                    <br>
                    <br>
                    <!-- gif of first slider moving from 50 to point where image heavily distorted--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/too_low_1.gif"> 
                    <br>
                    <br>
                    The slider is too far to the left and should be moved to the right to a higher quality, where the resulting compressed 
                    image looks exactly like the original image.
                    <br>
                    <br>
                    <!-- continuing from prev gif, first slider moves from "compressed too much" to point of first distortion-->  
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/too_low_2.gif"> 
                
            </div>
            
            <div class="begin3_class"style="display: none;">
                <p>
                    <!-- SECOND SLIDER INSTRUCTIONS -->
                    <h3>Second Slider</h3>
                    For the second slider, adjust the slider and try to find the point right before where the slider
                    <b>just begins to compromise the quality of the image</b>. The difference between the first and 
                    second sliders is that the resulting image and the original image can look different while having 
                    the same quality. The first slider asks you to find the point where the resulting and original images
                    look different but have the same quality, and the second slider asks you to find the location right 
                    before the point where the difference is large enough so that the quality of the resulting image is 
                    now slightly worse than the original quality. 
                    However, do <b>not</b> move the slider so much that the quality becomes bad. The compressed
                    image should have a quality that is only slightly worse than the original quality. Below are one 
                    good example and two bad examples.
                    <br>
                    <br>
                    <h5>Good Example</h5>
                    In the good example shown below, the slider is moved as far to the left as possible without causing a change in image
                    quality. Moving the slider slightly to the left will cause the resulting image's quality to drop, while moving the slider
                    to any point to the right will result in an image that may look different but has the same quality. Notice that differences
                    between the resulting image and the original image are noticeable but are not significant enough to cause a change in quality
                    from the original image to the resulting image.
                    <br>
                    <br>
                    <!-- gif of good example of slider -->
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/second_good.gif"> 
                    <br>
                    <br>
                    <br>
                    <h5>Bad Example 1</h5>
                    In the first bad example, the slider value is too high, since the image can be compressed further
                    (the slider can move more to the left) without changing the quality of the image. 
                    <br>
                    <br>
                    <!-- gif of second slider at starting point,  then compressed a little--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/second_bad_1_ver2.gif"> 
                    <br>
                    <br>
                    The resulting image's quality is similar to the original image's quality even after moving the slider 
                    a bit more to the left, as shown below. This means that you should keep moving the slider further to 
                    the left, since 26 is too high. 
                    <br>
                    <br>
                    <!-- continuing from prev gif, slider moves from "compressed a little" point to left and both images look same/have same quality--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/second_bad_2.gif"> 
                    <br>
                    <br>
                    <h5>Bad Example 2</h5>
                    In the second bad example, the slider is moved too far to the left, since there is a large drop in quality
                    in the resulting image when compared to the original. 
                    <br>
                    <br>
                    <!-- gif of second slider at starting point, then compressing too much--> 
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/second_toolow_1.gif"> 
                    <br>
                    <br>
                    In this case, the slider is too far to the left and should be moved back to the right. 
                    <br>
                    <br>
                    <!-- continuing from prev gif, slider moves from "compressed too much" to proper spot -->
                    <img style="text-indent: 25px;" src="https://snako.s3.us-east-2.amazonaws.com/second_toolow_2_rev2.gif"> 
                    <br>
                    <br>
                    <b>Note:</b> The images may start off with different initial qualities. Because of this, base your 
                    answer <b>relative to the original image</b> (i.e. when the slider bar is all the way to the 
                    right at 50). With some images, you may need to move the sliders a lot before seeing changes in the 
                    images. With others, you may not need to move the sliders too much before noticing a 
                    change. Your task is <b>not</b> to rate the aesthetic appeal of the content of the image. 
                </p>
            </div>
            <div class='begin4_class'style="display: none;">
                <h3>Recap:</h3>
                <p>
                    Moving a slider to the left lowers the quality of an image by compressing it, while moving a 
                    slider to the right results in a less compressed image with higher quality. The first slider 
                    should be moved as far to the left as possible while the compressed image still looks identical 
                    to the original image. The second slider should be moved to the point right before the quality 
                    of the resulting compressed image becomes slightly worse than the quality of the original image.
                    
                    <br>
                    <br>
                    Your judgement of image distortion and image quality may be different from what is shown in 
                    the tutorial clips, and that is OK! There is no exact right answer, and we are looking for 
                    your opinions of these images.
                    
                    <br>
                    <br>
                    During the study, once you click the next button, you will <b>NOT</b> be able to go back to the previous image. However, the instuctions will be availiable during the study for refrence.
                
                </p>
            </div>
            
            
            <div class='tutorial_complete_class'>
                <p>Tutorial complete! The "Next" button will appear when everything is loaded. When you are ready, click "Next" to proceed to the full study.</p>
            </div>
            <div class="quiz_class" style="text-align: left;">
                <div>
                    <p>For the first slider bar, you will need to move it left to the point at which </p>
                    <crowd-radio-group id='q1' class = 'q1'>
                        <input class="rads" type="radio" name="opt1" value="wrong"> the image through compression becomes blurry
                        <br>
                        <input class="rads" type="radio" name="opt1" value="right">the image shows first signs of distortion becomes noticeable
                        <br>
                        <input class="rads" type="radio" name="opt1" value="wrong">the image becomes unacceptable to the eye
                    </crowd-radio-group>
                    <!-- <crowd-checkbox name="q11" required> the image through compression becomes blurry</crowd-checkbox><br>
                    <crowd-checkbox name="q12" required> the image shows first signs of distortion becomes noticeable</crowd-checkbox><br>
                    <crowd-checkbox name="q13" required> the image becomes unacceptable to the eye</crowd-checkbox><br> -->
                </div>
                <br>
                <div>
                    <p>For the second slider bar, you will need to move it left to the point at which </p>
                    <crowd-radio-group id='q2'>
                        <input class="rads" type="radio" name="opt2" value="wrong"> the image through compression becomes blurry
                        <br>
                        <input class="rads" type="radio" name="opt2" value="wrong"> the image is still acceptable to the participant
                        <br>
                        <input class="rads" type="radio" name="opt2" value="right">the image quality just begins to be compromised by compression
                    </crowd-radio-group>
                    <!-- <crowd-checkbox name="q21" required> the image through the algorithm becomes pixelated</crowd-checkbox><br>
                    <crowd-checkbox name="q22" required> the image is still acceptable to the participant</crowd-checkbox><br>
                    <crowd-checkbox name="q23" required> the image quality just begins to be compromised by compression</crowd-checkbox><br> -->
                </div>
                <br>
                <div>
                    <p>You are evaluating the images based on their</p>
                    <crowd-radio-group id='q3'>
                        <input class="rads" type="radio" name="opt3" value="right"> quality 
                        <br>
                        <input class="rads" type="radio" name="opt3" value="wrong"> aesthetic 
                        <br>
                        <input class="rads" type="radio" name="opt3" value="wrong"> content
                    </crowd-radio-group>
                    <!-- <crowd-checkbox name="q31" required> quality</crowd-checkbox><br>
                    <crowd-checkbox name="q32" required> aesthetic</crowd-checkbox><br>
                    <crowd-checkbox name="q33" required> content</crowd-checkbox><br> -->
                </div>
                <br>
                <div>
                    <p>Will there be quality checks throughout the survey?</p>
                    <crowd-radio-group id='q4'>
                        <input class="rads" type="radio" name="opt4" value="right"> Yes
                        <br>
                        <input class="rads" type="radio" name="opt4" value="wrong"> No 
                        <br>
                        <input class="rads" type="radio" name="opt4" value="wrong"> I do not know
                    </crowd-radio-group>
                    <!-- <crowd-checkbox name="q41" required> Yes</crowd-checkbox><br>
                    <crowd-checkbox name="q42" required> No</crowd-checkbox><br>
                    <crowd-checkbox name="q43" required> I do not know</crowd-checkbox><br> -->
                </div>


            </div>
            
            <div class="not_supported_class">
                <p> Browser or device not supported. Please use Google Chrome, Mozilla Firefox, Microsoft Edge, or Opera on a desktop or laptop. </p>
            </div>

            <div class="reject" style="display: none;">
                <p id="reject_subject">Sorry, we are unable to collect your data because of failure to pass our quality checks! Please click "Return". </p>
            </div>
            <div class="failed_quiz" style="display: none;">
                <p id="failed_subject">Pay more attention! Please read the instructions again. </p>
            </div>


            <div class="end_class">
                <p id="task_complete">Task complete! Please click "Submit".</p>
            </div>
            <!-- <div  class="progress" id = "progress_class" > -->
            <div id="progress_bar_items" style="display: none;">
                <div id="progressbar" style="height: 20px;display: inline-block;"></div>
                <br>
            </div>
            <!-- </div> -->
            <div class="tutorial_text_class" style="text-align: center;">
                <p>Tutorial image:</p>
            </div>
            <div class="row justify-content-center">
                <div class="col-6">
                    <!-- <br> -->
                    <div class="image_class">
                        <img id="source_image" style="display: none;" crossOrigin="anonymous">
                        <img id="result_image" style="display: inline-block;" crossOrigin="anonymous">
                        <p style="text-align: center;display: inline;">
                            <label id="text_compression_ratio" fodisr="jpeg_encode_quality">Compression Ratio:</label>
                            <input type="text" id="jpeg_encode_quality" readonly style="border:0; color:#f6931f; font-weight:bold;">
                        </p>
                    </div>
                </div>
            </div>
            <br>
            <div class='row'>
                <div class='col-9 ' >
                    <div class="slider_class float-right" >
                        <div id="slider"></div>
                        <br>
                        <div id="slider2"></div>
                    </div>
                </div>
                <div class='col-3'>
                    <div>
                        <!-- <button type="button" class = "btn btn-primary btn-lg" onclick="setImageb(1)" id='Next_button' value="Next">Next</button>-->
                        <p>
                            <input style='width: 12em;' type="button" onclick="setImageb(1)" id='Next_button' value="Next" class="btn btn-primary"></input>
                        </p>
                        <p>
                            <input style='width: 12em;' type="button" onclick="goBack()" id='Back_button' value="Back" class="btn btn-primary"></input>
                        </p>
                        <crowd-input id='set_number' name='set_number' value='initial' type='hidden' style='display: none;'></crowd-input>
                        <crowd-input id='srcc_flag' name='srcc_flag' value='initial' type='hidden' style='display: none;'></crowd-input>
                        <crowd-input id='slider_values' name='slider_values' value='initial' type='hidden' style='display: none;'></crowd-input>
                        <crowd-input id='slider_values2' name='slider_values2' value='initial' type='hidden' style='display: none;'></crowd-input>
                        <input type="submit" id="submitButton" type='hidden' style='display: none;'>
                    </div>
                </div>
            </div>
            <br>
        </crowd-form>
    </div>
</body>

</html>


